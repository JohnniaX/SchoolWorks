}
lambdaD <- prod(thetaA/thetaB)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
-2*log(lambdaD)
rchisq(10,8)
min(rchisq(10000000,8))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB/thetaA)
print(paste('lambda_D=', lambdaD))
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB/thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
tbl1 <- table(thetaB,thetaA)
chisq.test(tbl1)
pchisq(-2*log(0.9), df=8, lower.tail=F)
pchisq(-2*log(0.5), df=8, lower.tail=F)
pchisq(-2*log(0.5), df=5, lower.tail=F)
pchisq(-2*log(0.5), df=3, lower.tail=F)
pchisq(-2*log(0.5), df=9, lower.tail=F)
pchisq(-2*log(1), df=8, lower.tail=F)
thetaA
thetaB
dat <- rnorm(10000,1,999)
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB/thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
?runif
dat <- runif(10000,min=1,max=999)
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB/thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB/thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB-thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
thetaB-thetaA
thetaB[1]-thetaA[1]
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB-thetaA)
print(paste('lambda_D=', lambdaD))
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB-thetaA)
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=8, lower.tail=F)
print(paste('pr=', pr))
flinstones <- readLines('flinstones.dat')
getwd()\
getwd()
flinstones <- readLines('flinstones_1.dat')
flintstones <- readLines('flintstones_1.dat')
flintstones <- readLines('flintstones_1.dat')
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3')
View(flintstones)
flintstones <- readLines('flintstones_1.dat', sep=' ')
flintstones <- read.delim('flintstones_1.dat', sep=' ')
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3')
View(flintstones)
flintstones <- as.vector(read.delim('flintstones_1.dat', sep=' '))
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3')
flintstones <- scan('flintstones_1.dat', sep=' ')
flintstones <- scan('flintstones_1.dat', sep=' ')
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3')
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3') +
geom_vline(aes(xintercept=l, col='data average l')) +
geom_vline(aes(xintercept=l, col='Expected length l0'))
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l')) +
geom_vline(aes(xintercept=l, col='Expected length l0'))
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l')) +
geom_vline(aes(xintercept=l0, col='Expected length l0'))
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l')) +
geom_vline(aes(xintercept=l0, col='expected length l0')) +
xlab('length measurement of flintstone') +
ylab('') + ggtitle(paste('Data with sample size', Sy)) +
theme(plot.title = element_text(hjust = 0.5))
flintstones <- scan('flintstones_1.dat', sep=' ', warning=F)
flintstones <- scan('flintstones_1.dat', sep=' ', warnings=F)
flintstones <- scan('flintstones_1.dat', sep=' ', warn=F)
flintstones <- scan('flintstones_1.dat', sep=' ', warns=F)
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l')) +
geom_vline(aes(xintercept=l0, col='expected length l0')) +
xlab('length measurement of flintstone') +
ylab('') + ggtitle(paste('Data with sample size=', Sy)) +
theme(plot.title = element_text(hjust = 0.5))
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l'),
lwd=1.2, linetype='dashed') +
geom_vline(aes(xintercept=l0, col='expected length l0')) +
xlab('length measurement of flintstone') +
ylab('') + ggtitle(paste('Data with sample size=', Sy)) +
theme(plot.title = element_text(hjust = 0.5))
flintstones <- scan('flintstones_1.dat', sep=' ')
l <- mean(flintstones)
l0 <- 8
Sy <- length(flintstones)
ggplot() + geom_histogram(aes(flintstones),
col='black',
fill='cornsilk3', bins=20) +
geom_vline(aes(xintercept=l, col='data average l'),
lwd=1.2, linetype='dashed') +
geom_vline(aes(xintercept=l0, col='expected length l0'),
lwd=1.2, linetype='dashed') +
xlab('length measurement of flintstone') +
ylab('') + ggtitle(paste('Data with sample size=', Sy)) +
theme(plot.title = element_text(hjust = 0.5))
length(which(abs(flintstones-l0)>=1))/Sy
which(abs(flintstones-l0)>=1)
flintstones-l0
min(flintstones)
max(flintstones)
lambdaD <- prod(thetaB-thetaA)/(1-prod(thetaB-thetaA))
lambdaD
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaB-thetaA)/(1-prod(thetaB-thetaA))
print(paste('lambda_D=', lambdaD))
length(which(abs(flintstones-l0)>=0.5))/Sy
t <- 0.5
length(which(abs(flintstones-l0)>=t))/Sy
1/(3*t^2)
t <- 0.3
length(which(abs(flintstones-l0)>=t))/Sy
1/(3*t^2)
t <- 0.1
length(which(abs(flintstones-l0)>=t))/Sy
1/(3*t^2)
t <- 1
length(which(abs(flintstones-l0)>=t))/Sy
1/(3*t^2)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
for (i in 1:9) {
thetaB[i] <- length(which(fd==i))/n
}
lambdaD <- prod(thetaA/thetaB)
print(paste('lambda_D=', lambdaD))
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni <- length(which(fd==i))
thetaB[i] <- ni/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB)
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB)
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB)
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
ni
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
nd <- length(dat)
td <- length(which(fd==1))
pr <- 1
for (t in 1:td) {
pr <- pr - choose(nd, t) * (1/9)^t * (8/9)^(nd-t)
}
pr
td <- 6
pr <- 1
for (t in 1:td) {
pr <- pr - choose(nd, t) * (1/9)^t * (8/9)^(nd-t)
}
pr
1 - sum(choose(nd, 1:td) * (1/9)^(1:td) * (8/9)^(nd-1:td))
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
nd <- length(dat)
td <- length(which(fd==1))
1 - sum(choose(nd, 1:td) * (1/9)^(1:td) * (8/9)^(nd-1:td))
td <- 6
1 - sum(choose(nd, 1:td) * (1/9)^(1:td) * (8/9)^(nd-1:td))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB)
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
sum(ni)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB^ni[i])
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB^ni[i])
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
lambdaD <- L_A/L_B
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB^ni[i])
factorial(1000)
L_B <- exp(log(factorial(n)) - sum(log(factorial(ni))) + sum(ni * log(thetaB[i])))
log(factorial(n))
factorial(ni)
log(99999)
log(999999999999999999)
log(99999999999999999999999999999999999999999)
prod(1:100000)
install.packages('Brobdingnag')
as.brob(factorial(n))
library(Brobdingnag)
as.brob(factorial(n))
factorial(as.brob(n))
lfactorial(n)
L_B <- exp(lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB[i])))
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
lfactorial(ni)
sum(lfactorial(ni))
lfactorial(n) - sum(lfactorial(ni))
a = c(1,2)
b = c(2,2)
b^a
c = c(2,3)
b^c
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')[1:60]
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- factorial(n)/prod(factorial(ni)) * prod(thetaB^ni)
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
dB <- 8
dA <- 0
d <- dB - dA
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
library(Brobdingnag)
thetaA <- rep(1/9, 9)
thetaB <- rep(NA, 9)
dat <- readLines('hw6_digits.dat')
fd <- sapply(dat,fdigit)
n <- length(dat)
ni <- rep(NA, 9)
for (i in 1:9) {
ni[i] <- length(which(fd==i))
thetaB[i] <- ni[i]/n
}
L_A <- prod(thetaA)
L_B <- exp(lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB)))
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
lfactorial(n) - sum(lfactorial(ni))
sum(ni * log(thetaB))
log(thetaB)
nn <- c(2,2,3,1,1,1,1,1,1)
log(thetaB)*nn
thetaB[1]*ni[1]
ni[1]
ni[1]/n
n/9
?lfactorial
lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB))
exp(lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB)))
prod(thetaA)
log(factorial(1:5))
sum(log(factorial(1:5)))
sum(lfactorial(1:5))
nn <- c(1,2,3,4,5)
mm <- c(2,3,4,5,6)
sum(nn*mm)
nn[1]*mm[1]+nn[2]*mm[2]+nn[3]*mm[3]+nn[4]*mm[4]+nn[5]*mm[5]
ni*log(thetaB)
sum(ni*log(thetaB))
L_B
L_A/sum(ni*log(thetaB))
kk <- L_A/sum(ni*log(thetaB))
pchisq(-2*log(kk), df=d, lower.tail=F)
kk
log(kk)
exp(sum(ni*log(thetaB)))
exp(-333)
log(L_A)
log(L_A)/log(L_B)
pchisq(-2*log(0.5468412), df=d, lower.tail=F)
log(L_A)-log(L_B)
pchisq(-2*log(16.38725), df=d, lower.tail=F)
L_B <- lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB))
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
exp(-36)
0.1^9
L_A
sum(ni)
n
sum(thetaB)
L_B <- exp(lfactorial(n) - sum(lfactorial(ni)) + sum(ni * log(thetaB)))
lambdaD <- L_A/L_B
print(paste('lambda_D=', lambdaD))
pr <- pchisq(-2*log(lambdaD), df=d, lower.tail=F)
print(paste('pr=', pr))
